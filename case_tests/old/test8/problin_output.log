Launching Problin version 0.2
Problin was called as follow: ../../run_problin.py -c character_matrix.csv -t tree.nwk -p prior_k30_r01.csv --delimiter comma -o problin_output.txt --nInitials 1 --randomreps 1 --topology_search -v --ultrametric
30
Optimization by EM algorithm
Starting topology search
Performing nni-search 1
Perform nni moves for full topology search
Initial score: -6987.352328368135
NNI Iter: 0
Time 1.078833375000002
-6987.352328368135 -6987.404205727598 accept
Current score: -6987.404205727598
NNI Iter: 1
Time 1.6940079169999933
-6987.404205727598 -6994.098274268591 reject
Time 1.9433356250000031
-6987.404205727598 -6994.085034188419 reject
Time 2.3596379579999933
-6987.404205727598 -6989.227909654331 reject
Time 3.7717230419999908
-6987.404205727598 -6989.205821238972 reject
Time 1.1557635000000062
-6987.404205727598 -6987.436618539696 accept
Current score: -6987.436618539696
NNI Iter: 2
Time 4.189272375000002
-6987.436618539696 -6988.565217318877 reject
Time 1.1127348330000046
-6987.436618539696 -6988.496297813242 accept
Current score: -6988.496297813242
NNI Iter: 3
Time 1.2715765410000017
-6988.496297813242 -6988.584691412721 accept
Current score: -6988.584691412721
NNI Iter: 4
Time 1.0286159590000068
-6988.584691412721 -6991.124226970471 reject
Time 1.3440638339999964
-6988.584691412721 -6991.091073352278 reject
Time 1.7904330000000073
-6988.584691412721 -6994.459552926239 reject
Time 3.6816561249999893
-6988.584691412721 -6994.344215248546 reject
Time 1.444142040999992
-6988.584691412721 -6990.045564439306 reject
Time 1.3064341250000098
-6988.584691412721 -6990.04523221375 reject
Time 1.0730533330000185
-6988.584691412721 -6997.609915787412 reject
Time 1.0778902920000064
-6988.584691412721 -6997.653218270786 reject
Time 1.2273729169999967
-6988.584691412721 -6993.684396979661 reject
Time 1.0184189170000195
-6988.584691412721 -6993.653618068971 reject
Time 1.0663666250000006
-6988.584691412721 -6988.5445390525665 accept
Current score: -6988.5445390525665
NNI Iter: 5
Time 1.4764385000000004
-6988.5445390525665 -6988.864896891964 reject
Time 1.498308584
-6988.5445390525665 -6988.886190334925 accept
Current score: -6988.886190334925
NNI Iter: 6
Time 1.3145036250000146
-6988.886190334925 -6996.2238190922235 reject
Time 1.2830151659999842
-6988.886190334925 -6996.221481155026 reject
Time 1.2843537920000188
-6988.886190334925 -6992.65332821632 reject
Time 1.0672550000000172
-6988.886190334925 -6992.694711771563 reject
Time 1.2620759580000254
-6988.886190334925 -6989.716991400282 reject
Time 1.54059291599998
-6988.886190334925 -6989.711668898407 reject
Time 1.0731609169999956
-6988.886190334925 -6988.831575833335 accept
Current score: -6988.831575833335
NNI Iter: 7
Time 1.3530409159999977
-6988.831575833335 -6994.682634314274 reject
Time 1.3414117499999634
-6988.831575833335 -6994.696675721012 reject
Time 1.1605650000000196
-6988.831575833335 -6989.024142866049 reject
Time 1.1026202499999727
-6988.831575833335 -6989.003211426965 accept
Current score: -6989.003211426965
NNI Iter: 8
Time 5.793242915999997
-6989.003211426965 -6988.931840861489 accept
Current score: -6988.931840861489
NNI Iter: 9
Time 1.2343931670000075
-6988.931840861489 -6990.7181104849515 reject
Time 3.8521111250000217
-6988.931840861489 -6990.638921623123 reject
Time 1.8704000000000178
-6988.931840861489 -6993.905698849379 reject
Time 1.0789363749999552
-6988.931840861489 -6993.952197226141 reject
Time 1.5421831670000188
-6988.931840861489 -6993.215849243848 reject
Time 1.222880790999966
-6988.931840861489 -6993.200354866391 reject
Time 1.4978347500000382
-6988.931840861489 -6989.7667195610575 reject
Time 1.2777815410000244
-6988.931840861489 -6989.749253167206 reject
Time 3.9824529580000103
-6988.931840861489 -6995.031672866528 reject
Time 1.4556767079999986
-6988.931840861489 -6995.07802031898 reject
Time 0.8552775829999746
-6988.931840861489 -7001.607556307096 reject
Time 0.9581607079999799
-6988.931840861489 -7001.6103385346205 reject
Time 1.3626144590000422
-6988.931840861489 -6995.491863575523 reject
Time 1.9241544580000323
-6988.931840861489 -6995.42952146777 reject
Time 1.8645367500000134
-6988.931840861489 -6989.62129588066 reject
Time 2.534555624999996
-6988.931840861489 -6989.596182388999 reject
Time 1.036650542000018
-6988.931840861489 -7000.651776230258 reject
Time 1.6908769579999898
-6988.931840861489 -7000.614983125559 reject
Time 4.441540833000033
-6988.931840861489 -6992.075712310792 reject
Time 1.0652242080000178
-6988.931840861489 -6992.215881598518 reject
Time 1.6582874160000074
-6988.931840861489 -6992.449776041927 reject
Time 1.7834868340000298
-6988.931840861489 -6992.455726515089 reject
Time 2.063241624999989
-6988.931840861489 -6989.254799735661 accept
Current score: -6989.254799735661
NNI Iter: 10
Time 1.90771675000002
-6989.254799735661 -6995.752137479803 reject
Time 1.4289474159999713
-6989.254799735661 -6995.814485620275 reject
Time 0.8234760830000027
-6989.254799735661 -7001.93147546938 reject
Time 0.8774855830000092
-6989.254799735661 -7001.93426427258 reject
Time 4.576308707999999
-6989.254799735661 -6989.265665877325 accept
Current score: -6989.265665877325
NNI Iter: 11
Time 1.265629792000027
-6989.265665877325 -6995.442137047868 reject
Time 1.2989599580000117
-6989.265665877325 -6995.401119884266 reject
Time 2.1770310829999744
-6989.265665877325 -6988.68889314742 accept
Current score: -6988.68889314742
NNI Iter: 12
Time 1.2180937919999906
-6988.68889314742 -6992.94344560871 reject
Time 1.4236652920000097
-6988.68889314742 -6991.875320403518 reject
Time 1.0504159170000094
-6988.68889314742 -6988.807639571355 accept
Current score: -6988.807639571355
NNI Iter: 13
Time 2.05713383300008
-6988.807639571355 -6988.802565071537 accept
Current score: -6988.802565071537
NNI Iter: 14
Time 1.7145498339999676
-6988.802565071537 -6988.859633991821 accept
Current score: -6988.859633991821
NNI Iter: 15
Time 0.808206167000094
-6988.859633991821 -6988.842453583358 accept
Current score: -6988.842453583358
NNI Iter: 16
Time 3.924163416000056
-6988.842453583358 -6993.724988959179 reject
Time 1.4725780830000303
-6988.842453583358 -6993.800962912055 reject
Time 1.264908791000039
-6988.842453583358 -6989.43284964752 reject
Time 1.2618541660000346
-6988.842453583358 -6989.382410240656 reject
Traceback (most recent call last):
  File "/Users/uym2/my_gits/problin/case_tests/test8/../../run_problin.py", line 195, in <module>
    main()
  File "/Users/uym2/my_gits/problin/case_tests/test8/../../run_problin.py", line 181, in main
    nni_replicates = myTopoSearch.search(maxiter=200, verbose=args["verbose"], strategy=my_strategy, nreps=args['randomreps']) 
  File "/Users/uym2/my_gits/problin/problin_libs/Topology_search.py", line 96, in search
    topo_list,best_score = self.__search_one__(strategy,maxiter=maxiter,verbose=verbose,only_marked=False)
  File "/Users/uym2/my_gits/problin/problin_libs/Topology_search.py", line 117, in __search_one__
    new_score,n_attempts,success = self.single_nni(curr_score,nni_iter,strategy,only_marked=only_marked)
  File "/Users/uym2/my_gits/problin/problin_libs/Topology_search.py", line 144, in single_nni
    took,score = self.apply_nni(u,curr_score,nni_iter,strategy)
  File "/Users/uym2/my_gits/problin/problin_libs/Topology_search.py", line 197, in apply_nni
    new_score = mySolver.score_tree(strategy=score_tree_strategy)
  File "/Users/uym2/my_gits/problin/problin_libs/ML_solver.py", line 157, in score_tree
    nllh = self.optimize(initials=1,verbose=-1,ultra_constr=ultra_constr,fixed_phi=fixed_phi,fixed_nu=fixed_nu,fixed_brlen=fixed_brlen)
  File "/Users/uym2/my_gits/problin/problin_libs/ML_solver.py", line 358, in optimize
    nllh = self.optimize_one(randseed,fixed_phi=fixed_phi,fixed_nu=fixed_nu,verbose=verbose,ultra_constr=ultra_constr)
  File "/Users/uym2/my_gits/problin/problin_libs/EM_solver.py", line 433, in optimize_one
    nllh, em_iter = self.EM_optimization(verbose=verbose,optimize_phi=(fixed_phi is None),optimize_nu=(fixed_nu is None),ultra_constr=ultra_constr)
  File "/Users/uym2/my_gits/problin/problin_libs/EM_solver.py", line 403, in EM_optimization
    if not self.Mstep(optimize_phi=optimize_phi,optimize_nu=optimize_nu,verbose=verbose,ultra_constr=ultra_constr,local_brlen_opt=True):
  File "/Users/uym2/my_gits/problin/problin_libs/EM_solver.py", line 380, in Mstep
    node.edge_length = d_star[i]
TypeError: 'NoneType' object is not subscriptable
